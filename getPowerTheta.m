%Fz = 38
clear all
close all
names = {'AGE002','AGE003','AGE005','AGE007','AGE008','AGE012','AGE013', ...
    'AGE014','AGE015','AGE017','AGE018','AGE019','AGE020','AGE021', ...
    'AGE022','AGE023','AGE024','AGE026','AGE027','AGE028','AGE030', ...
    'AGE032','AGE033','AGE035','AGE036','AGE038','AGE046','AGE047', ...
    'AGE050','AGE051','AGE052','AGE053','AGE059','AGE061','AGE062', ...
    'AGE063','AGE064','AGE066','AGE067','AGE068','AGE069','AGE070', ...
    'AGE072','AGE075','AGE077','AGE081','AGE083','AGE084','AGE085', ...
    'AGE086','AGE088','AGE089','AGE090','AGE092','AGE093','AGE094', ...
    'AGE095','AGE096','AGE097','AGE098','AGE100','AGE102','AGE103', ...
    'AGE104','AGE106','AGE107','AGE108','AGE109','AGE114','AGE115', ...
    'AGE116','AGE117','AGE118','AGE119','AGE120','AGE121','AGE122', ...
    'AGE123','AGE124','AGE128','AGE129','AGE130','AGE131','AGE133', ...
    'AGE134','AGE136','AGE138','AGE146','AGE147','AGE148','AGE149', ...
    'AGE150','AGE151','AGE152','AGE153','AGE155','AGE156','AGE158', ...
    'AGE159','AGE161','AGE162','AGE164','AGE165','AGE166','AGE167', ...
    'AGE168','AGE169','AGE170','AGE172','AGE175','AGE176','AGE177', ...
    'AGE178','AGE180','AGE181','AGE182','AGE184','AGE185','AGE186', ...
    'AGE187','AGE195'};
conditions = {'mixrepeat' 'switchto' 'switchaway' 'noninf'};
theta = 19:31;
scale = 19:31;
times = 800:200:3800;
timeticks = times-800;
timeticks = mat2cell(timeticks,1,16);
timeticks{2} = '';timeticks{4}= '';timeticks{6}= '';timeticks{8}= '';timeticks{10}= '';
power = [];
power.mixrepeat =  zeros(length(names),length(scale),length(times));
power.switchto =  zeros(length(names),length(scale),length(times));
power.switchaway =  zeros(length(names),length(scale),length(times));
power.noninf =  zeros(length(names),length(scale),length(times));
CWD = 'G:\fieldtrip\DOWNSAMPLE\WAVELET_OUTPUT\';
addpath('G:\fieldtrip\DOWNSAMPLE\FUNCTIONS');
% ticks = [4.16435718122703,4.33753922765803,4.51792335112057, ...
%     4.70580906253185,4.90150832849220,5.10534608927639, ...
%     5.31766079836647,5.53880498442202,5.76914583662093, ... 
%     6.00906581434257,6.25896328220573,6.51925317151574, ...
%     6.79036766921890,7.07275693550844,7.36688985127325, ...
%     7.67325479663065,7.99236046183574,8.32473669191385, ...
%     8.67093536641855,9.03153131577582,9.40712327573611, ...
%     9.79833488151886,10.2058157033003,10.6302423247637, ...
%     11.0723194665034,11.5327811561470,12.0123919471392, ...
%     12.5119481882116,13.0322793456449,13.5742493805193, ...
%     14.1387581832418,14.7267430677289,15.3391803277291, ...
%     15.9770868578668,16.6415218421003,17.3335885123978, ...
%     18.0544359805502,18.8052611461639,19.5873106839998, ...
%     20.4018831139602,21.2503309571590,22.1340629816566];
ticks = [4.16435718122703, ...
    4.70580906253185, ...
    5.31766079836647, ... 
    6.00906581434257, ...
    6.79036766921890, ...
    7.67325479663065];% ...
%     8.67093536641855, ...
%     9.79833488151886, ...
%     11.0723194665034, ...
%     12.5119481882116, ...
%     14.1387581832418, ...
%     15.9770868578668, ...
%     18.0544359805502, ...
%     20.4018831139602];

ticks = sort(ticks,'descend');
ticks = mat2cell(ticks,1,6);
h = waitbar(0,'Loading . . .');
channelofinterest = 'put numbers here Alex';
for name_i = 1:length(names)
    waitbar(name_i/length(names),h)
    for cond_i = 1:length(conditions)
        load([CWD names{name_i} '\' conditions{cond_i} '\' names{name_i} '_' conditions{cond_i} '_38_imagcoh_mwtf.mat'])
        power.(conditions{cond_i})(name_i,:,:) = mw_tf(scale,times);
        clear mw_tf
    end
end
close(h);
for cond_i = 1:length(conditions)
    for x = 1:size(power.(conditions{cond_i}),2);
        if x == 1
            power2.(conditions{cond_i})(:,x,:) = power.(conditions{cond_i})(:,end,:);
        elseif x == size(power.(conditions{cond_i}),2)
            power2.(conditions{cond_i})(:,x,:) = power.(conditions{cond_i})(:,end-x+1,:);
        else
            power2.(conditions{cond_i})(:,x,:) = power.(conditions{cond_i})(:,end-x,:);
        end
    end
end
figure();
set(gcf,'Color',[1 1 1]);
hold on;
for cond_i = 1:length(conditions)
    subplot(2,2,cond_i); imagesc(squeeze(mean(power2.(conditions{cond_i}),1)));
    title(conditions{cond_i});
    set(gca,'YTick',1:2.1667:13,'XTick',1:400:2001,'XTickLabel',timeticks{1,1},'YTickLabel',ticks{1,1});
    caxis([-1 0.5]);
end
saveas(gcf,'H:\Theta_FFT_Plots.pdf','pdf');